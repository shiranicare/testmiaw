<html>
  <body>
    <h1>MIAW Test</h1>
    <script type='text/javascript' src='https://icare--crmi3.sandbox.my.site.com/ESWMIAWChatDeployment1738131985084/assets/js/bootstrap.min.js'></script>
    <button id="launchChatButton" onclick="launchChat()">
        Chat with our Agents!!!
    </button>

    <script type='text/javascript'>
    function initEmbeddedMessaging() {
        try {
            embeddedservice_bootstrap.settings.language = 'en_US'; // For example, enter 'en' or 'en-US'

            embeddedservice_bootstrap.init(
                '00D9p000003iexh',
                'MIAW_Chat_Deployment',
                'https://icare--crmi3.sandbox.my.site.com/ESWMIAWChatDeployment1738131985084',
                {
                    scrt2URL: 'https://icare--crmi3.sandbox.my.salesforce-scrt.com'
                }
            );
        } catch (err) {
            console.error('Error loading Embedded Messaging: ', err);
        }
    };
    function launchChat() {
        
            /*
                For session continuity , sessionStorage is used.
            */
            sessionStorage.setItem(
                'messagingStartCheck',
                'YES'
            );
            initEmbeddedMessaging();
            console.log("Loading Messaging now");
            setTimeout(() => {
                embeddedservice_bootstrap.utilAPI
                    .launchChat()
                    .then(() => {
                        console.log("Inside Launch Chat");
                    })
                    .catch(() => {
                        console.log("Inside Launch Chat catch Block");
                    })
                    .finally(() => {
                        console.log("Inside Launch Chat finally Block");
                    });
            }, 2000);
            
        }
</script>

  </body>
</html>
